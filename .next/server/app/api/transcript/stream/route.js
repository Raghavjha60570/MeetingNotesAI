"use strict";(()=>{var e={};e.id=425,e.ids=[425],e.modules={2934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2048:e=>{e.exports=require("fs")},2615:e=>{e.exports=require("http")},5240:e=>{e.exports=require("https")},5315:e=>{e.exports=require("path")},8621:e=>{e.exports=require("punycode")},6162:e=>{e.exports=require("stream")},7360:e=>{e.exports=require("url")},1764:e=>{e.exports=require("util")},2623:e=>{e.exports=require("worker_threads")},1568:e=>{e.exports=require("zlib")},7561:e=>{e.exports=require("node:fs")},4492:e=>{e.exports=require("node:stream")},2477:e=>{e.exports=require("node:stream/web")},1433:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>_,patchFetch:()=>f,requestAsyncStorage:()=>g,routeModule:()=>x,serverHooks:()=>q,staticGenerationAsyncStorage:()=>h});var s={};r.r(s),r.d(s,{GET:()=>m,handleWebSocketMessage:()=>l,runtime:()=>c});var i=r(9303),n=r(8716),a=r(670),o=r(5456),p=r(4214);let u=new Map,c="nodejs",d=new p.ZP({apiKey:process.env.OPENAI_API_KEY});async function m(e){return e.nextUrl.searchParams.get("meeting_id")?new Response("WebSocket endpoint - implementation in progress",{status:501,headers:{"Content-Type":"text/plain"}}):new Response("Meeting ID is required",{status:400})}async function l(e,t,r){try{let s=(0,o.fU)();if("audio_chunk"===t.type){let i=Buffer.from(t.audio,"base64"),n=await d.audio.transcriptions.create({file:new File([i],"audio.wav",{type:"audio/wav"}),model:"whisper-1",response_format:"json"});if(n.text){let{error:i}=await s.from("transcript_chunks").insert({meeting_id:r,text:n.text,start_time:t.startTime||"00:00:00",end_time:t.endTime||"00:00:05",status:"completed"});i&&console.error("Error saving transcript:",i),e.send(JSON.stringify({type:"transcription",text:n.text,startTime:t.startTime,endTime:t.endTime}))}}else"start_meeting"===t.type?(await s.from("meetings").update({status:"in_progress",start_time:new Date().toISOString()}).eq("id",r),u.set(r,e)):"end_meeting"===t.type&&(await s.from("meetings").update({status:"completed",end_time:new Date().toISOString()}).eq("id",r),u.delete(r),e.close())}catch(t){console.error("Error handling WebSocket message:",t),e.send(JSON.stringify({type:"error",message:"Failed to process audio chunk"}))}}let x=new i.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/transcript/stream/route",pathname:"/api/transcript/stream",filename:"route",bundlePath:"app/api/transcript/stream/route"},resolvedPagePath:"/Users/ankursingh/Test-cursor/live-meeting-notes/src/app/api/transcript/stream/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:g,staticGenerationAsyncStorage:h,serverHooks:q}=x,_="/api/transcript/stream/route";function f(){return(0,a.patchFetch)({serverHooks:q,staticGenerationAsyncStorage:h})}},9303:(e,t,r)=>{e.exports=r(517)},5456:(e,t,r)=>{r.d(t,{fU:()=>n});var s=r(7122),i=r(1615);let n=()=>{let e=(0,i.cookies)();return(0,s.lx)(process.env.NEXT_PUBLIC_SUPABASE_URL,process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,{cookies:{get:t=>e.get(t)?.value,set(t,r,s){try{e.set({name:t,value:r,...s})}catch(e){}},remove(t,r){try{e.set({name:t,value:"",...r})}catch(e){}}}})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[276,554,706,214],()=>r(1433));module.exports=s})();